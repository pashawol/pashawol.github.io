$(function(){$(".top-nav a, .trop.main-mnu a, .header-btn").click(function(){var elementClick=$(this).attr("href");var destination=$(elementClick).offset().top;$('html, body').animate({scrollTop:destination},1100);return false;});var toggMnu=$(".toggle-mnu-1").click(function(){$(this).toggleClass("on");$(".hidden-mnu").slideToggle();return false;});$('.hidden-mnu ul li a').on('click',function(){$(".toggle-mnu-1").click();});$(".btn-modal").each(function(){$(this).attr("href","#small-dialog")})
$("input[type='tel']").inputmask("+7(999)999-99-99").attr("pattern","[+]7[(][0-9]{3}[)][0-9]{3}-[0-9]{2}-[0-9]{2}");$('.btn-modal').magnificPopup({type:'inline',fixedContentPos:true,fixedBgPos:true,overflowY:'auto',closeBtnInside:true,preloader:false,midClick:true,removalDelay:300,mainClass:'my-mfp-zoom-in'});$(".calc__item").each(function(){var th=$(this),symbol=th.data("symbol")
th.find(".calc__range").slider({range:"max",min:0,max:10000,value:1,slide:function(event,ui){th.find(".calc__price ").val(ui.value+" "+symbol);}});});$('.popup-youtube, .popup-vimeo, .popup-gmaps').magnificPopup({type:'iframe',mainClass:'mfp-fade',removalDelay:160,preloader:false,fixedContentPos:false});$(".incr-btn").on("click",function(e){var $button=$(this);var oldValue=$button.parent().find('.quantity').val();$button.parent().find('.incr-btn[data-action="decrease"]').removeClass('inactive');if($button.data('action')=="increase"){var newVal=parseFloat(oldValue)+1;}else{if(oldValue>1){var newVal=parseFloat(oldValue)-1;}else{newVal=1;$button.addClass('inactive');}}$button.parent().find('.quantity').val(newVal);e.preventDefault();});var navbar=$('.s-form__total');var wrapper=$('.s-form__wrap');$(window).scroll(function(){var nsc=$(document).scrollTop();var bp1=wrapper.offset().top;var bp2=$('.s-ways').offset().top-300;var h=$('.top-nav').outerHeight();if(nsc>bp1){navbar.css({position:'fixed',top:h+"px"});}else{navbar.css('position','relative');}if(nsc>bp2){navbar.css('top',bp2-nsc);}else{navbar.css('top',h+"px");}});function heightses(){$(".s-form__label-title label ").height('auto').equalHeights();var w=$(window).width();var w=$(window).width();var topH=$("header ").innerHeight();if($(this).scrollTop()>topH){$('.top-nav  ').addClass('fixed');}else if($(this).scrollTop()<topH){$('.top-nav  ').removeClass('fixed');}$(window).scroll(function(){if($(this).scrollTop()>topH){$('.top-nav  ').addClass('fixed');}else if($(this).scrollTop()<topH){$('.top-nav  ').removeClass('fixed');}});}$(window).resize(function(){heightses();});$(window).on("load",function(){heightses();})
heightses();$(".s-ways__item").each(function(){$(this).find('.popovers').popover({'html':true,})});$(".s-form__color-item").click(function(){var th=$(this);th.addClass("active").siblings().removeClass('active');th.parents(".s-form__item-prod").find(".s-form__img-wrap").css('background-image','url('+th.data("src")+')');var color=$(this).data('color');$('[name="color"]').val(color);})
$(".dop-file").on('change',function(){$(".s-form__dop-file").slideDown();$(".s-form__block-osn").slideUp();})
$(".dop-new").on('change',function(){$(".s-form__dop-file").slideUp();$(".s-form__block-osn").slideDown();})});$(document).ready(function(){var price={vid:{ottisk:[350,700],new_p:[250,400],},osn:{ruch:0,poluavt:350,avtomatr40:300,avtomathummer:350,avtusilhummer:400,avtpod:550,proffhummer:900,poluavtpocket:450,poluavttablet:300}},$form=$('#calc_form'),$error_block=$('#error_block'),$total=$('#total');$('[type="radio"]',$form).change(function(event){calc();});$('[name="quantity"]',$form).change(function(event){calc();});$('.incr-btn',$form).click(function(event){calc();});$('[name="obr"]',$form).each(function(index,el){var src=$(this).parent().siblings('img').attr('src');$(this).val(location.href+src);});calc();function calc(){var total=0;var vid=$('[name="vid"]:checked').val(),time=$('[name="time"]:checked').val(),quantity=$('.quantity').val();total=price.vid[vid][time];var osn=$('[name="osn"]:checked').val();if(typeof osn!=="undefined"){total+=parseInt(price.osn[osn]);}total=total*parseInt(quantity);var delliviry=$('[name="доставка"]:checked').val();if(typeof delliviry!=="undefined"&&delliviry=="да"){total+=250;}$total.html(STD(total)+'<i class="demo-icon icon-rouble"></i>')
$('[name=total]').val(total);}$form.submit(function(event){event.preventDefault();if(valid()){var formData=new FormData(this);$('.btn-info',$form).prop('disabled',true);$.ajax({url:'mailer/mail.php',type:'POST',data:formData,async:false,cache:false,contentType:false,processData:false}).done(function(){$('.btn-modal[href="#small-dialog"]').trigger('click');}).fail(function(){console.log("error");}).always(function(){$('.btn-info',$form).prop('disabled',false);});}return false;});function valid(){var b=true;var error="Укажите ";$error_block.html("").addClass('hidden');$('.req',$form).each(function(index,el){if($(this).val()==""){error=error+" "+$(this).attr('placeholder');b=false;}});if(!b){$error_block.html(error).removeClass('hidden');}return b;}function STD(summ){return summ.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1 ");}});