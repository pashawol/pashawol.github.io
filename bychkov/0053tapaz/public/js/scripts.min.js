!function(e,t){"function"==typeof define&&define.amd?define([],function(){return e.svg4everybody=t()}):"object"==typeof module&&module.exports?module.exports=t():e.svg4everybody=t()}(this,function(){function v(e,t,a){if(a){var n=document.createDocumentFragment(),i=!t.hasAttribute("viewBox")&&a.getAttribute("viewBox");i&&t.setAttribute("viewBox",i);for(var o=a.cloneNode(!0);o.childNodes.length;)n.appendChild(o.firstChild);e.appendChild(n)}}function g(n){n.onreadystatechange=function(){if(4===n.readyState){var a=n._cachedDocument;a||((a=n._cachedDocument=document.implementation.createHTMLDocument("")).body.innerHTML=n.responseText,n._cachedTarget={}),n._embeds.splice(0).map(function(e){var t=n._cachedTarget[e.id];t||(t=n._cachedTarget[e.id]=a.getElementById(e.id)),v(e.parent,e.svg,t)})}},n.onreadystatechange()}function y(e){for(var t=e;"svg"!==t.nodeName.toLowerCase()&&(t=t.parentNode););return t}return function(e){var d,u=Object(e),t=window.top!==window.self;d="polyfill"in u?u.polyfill:/\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/.test(navigator.userAgent)||(navigator.userAgent.match(/\bEdge\/12\.(\d+)\b/)||[])[1]<10547||(navigator.userAgent.match(/\bAppleWebKit\/(\d+)\b/)||[])[1]<537||/\bEdge\/.(\d+)\b/.test(navigator.userAgent)&&t;var p={},f=window.requestAnimationFrame||setTimeout,m=document.getElementsByTagName("use"),h=0;d&&function e(){for(var t=0;t<m.length;){var a=m[t],n=a.parentNode,i=y(n),o=a.getAttribute("xlink:href")||a.getAttribute("href");if(!o&&u.attributeName&&(o=a.getAttribute(u.attributeName)),i&&o){if(d)if(!u.validate||u.validate(o,i,a)){n.removeChild(a);var s=o.split("#"),r=s.shift(),l=s.join("#");if(r.length){var c=p[r];c||((c=p[r]=new XMLHttpRequest).open("GET",r),c.send(),c._embeds=[]),c._embeds.push({parent:n,svg:i,id:l}),g(c)}else v(n,i,document.getElementById(l))}else++t,++h}else++t}(!m.length||0<m.length-h)&&f(e,67)}()}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):window.jQuery||window.Zepto)}(function(d){var u,n,p,i,f,t,l="Close",c="BeforeClose",m="MarkupParse",h="Open",v=".mfp",g="mfp-ready",a="mfp-removing",s="mfp-prevent-close",e=function(){},r=!!window.jQuery,y=d(window),b=function(e,t){u.ev.on("mfp"+e+v,t)},k=function(e,t,a,n){var i=document.createElement("div");return i.className="mfp-"+e,a&&(i.innerHTML=a),n?t&&t.appendChild(i):(i=d(i),t&&i.appendTo(t)),i},w=function(e,t){u.ev.triggerHandler("mfp"+e,t),u.st.callbacks&&(e=e.charAt(0).toLowerCase()+e.slice(1),u.st.callbacks[e]&&u.st.callbacks[e].apply(u,d.isArray(t)?t:[t]))},C=function(e){return e===t&&u.currTemplate.closeBtn||(u.currTemplate.closeBtn=d(u.st.closeMarkup.replace("%title%",u.st.tClose)),t=e),u.currTemplate.closeBtn},o=function(){d.magnificPopup.instance||((u=new e).init(),d.magnificPopup.instance=u)};e.prototype={constructor:e,init:function(){var e=navigator.appVersion;u.isIE7=-1!==e.indexOf("MSIE 7."),u.isIE8=-1!==e.indexOf("MSIE 8."),u.isLowIE=u.isIE7||u.isIE8,u.isAndroid=/android/gi.test(e),u.isIOS=/iphone|ipad|ipod/gi.test(e),u.supportsTransition=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}(),u.probablyMobile=u.isAndroid||u.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),p=d(document),u.popupsCache={}},open:function(e){var t;if(!1===e.isObj){u.items=e.items.toArray(),u.index=0;var a,n=e.items;for(t=0;t<n.length;t++)if((a=n[t]).parsed&&(a=a.el[0]),a===e.el[0]){u.index=t;break}}else u.items=d.isArray(e.items)?e.items:[e.items],u.index=e.index||0;if(!u.isOpen){u.types=[],f="",e.mainEl&&e.mainEl.length?u.ev=e.mainEl.eq(0):u.ev=p,e.key?(u.popupsCache[e.key]||(u.popupsCache[e.key]={}),u.currTemplate=u.popupsCache[e.key]):u.currTemplate={},u.st=d.extend(!0,{},d.magnificPopup.defaults,e),u.fixedContentPos="auto"===u.st.fixedContentPos?!u.probablyMobile:u.st.fixedContentPos,u.st.modal&&(u.st.closeOnContentClick=!1,u.st.closeOnBgClick=!1,u.st.showCloseBtn=!1,u.st.enableEscapeKey=!1),u.bgOverlay||(u.bgOverlay=k("bg").on("click"+v,function(){u.close()}),u.wrap=k("wrap").attr("tabindex",-1).on("click"+v,function(e){u._checkIfClose(e.target)&&u.close()}),u.container=k("container",u.wrap)),u.contentContainer=k("content"),u.st.preloader&&(u.preloader=k("preloader",u.container,u.st.tLoading));var i=d.magnificPopup.modules;for(t=0;t<i.length;t++){var o=i[t];o=o.charAt(0).toUpperCase()+o.slice(1),u["init"+o].call(u)}w("BeforeOpen"),u.st.showCloseBtn&&(u.st.closeBtnInside?(b(m,function(e,t,a,n){a.close_replaceWith=C(n.type)}),f+=" mfp-close-btn-in"):u.wrap.append(C())),u.st.alignTop&&(f+=" mfp-align-top"),u.fixedContentPos?u.wrap.css({overflow:u.st.overflowY,overflowX:"hidden",overflowY:u.st.overflowY}):u.wrap.css({top:y.scrollTop(),position:"absolute"}),(!1===u.st.fixedBgPos||"auto"===u.st.fixedBgPos&&!u.fixedContentPos)&&u.bgOverlay.css({height:p.height(),position:"absolute"}),u.st.enableEscapeKey&&p.on("keyup"+v,function(e){27===e.keyCode&&u.close()}),y.on("resize"+v,function(){u.updateSize()}),u.st.closeOnContentClick||(f+=" mfp-auto-cursor"),f&&u.wrap.addClass(f);var s=u.wH=y.height(),r={};if(u.fixedContentPos&&u._hasScrollBar(s)){var l=u._getScrollbarSize();l&&(r.marginRight=l)}u.fixedContentPos&&(u.isIE7?d("body, html").css("overflow","hidden"):r.overflow="hidden");var c=u.st.mainClass;return u.isIE7&&(c+=" mfp-ie7"),c&&u._addClassToMFP(c),u.updateItemHTML(),w("BuildControls"),d("html").css(r),u.bgOverlay.add(u.wrap).prependTo(u.st.prependTo||d(document.body)),u._lastFocusedEl=document.activeElement,setTimeout(function(){u.content?(u._addClassToMFP(g),u._setFocus()):u.bgOverlay.addClass(g),p.on("focusin"+v,u._onFocusIn)},16),u.isOpen=!0,u.updateSize(s),w(h),e}u.updateItemHTML()},close:function(){u.isOpen&&(w(c),u.isOpen=!1,u.st.removalDelay&&!u.isLowIE&&u.supportsTransition?(u._addClassToMFP(a),setTimeout(function(){u._close()},u.st.removalDelay)):u._close())},_close:function(){w(l);var e=a+" "+g+" ";if(u.bgOverlay.detach(),u.wrap.detach(),u.container.empty(),u.st.mainClass&&(e+=u.st.mainClass+" "),u._removeClassFromMFP(e),u.fixedContentPos){var t={marginRight:""};u.isIE7?d("body, html").css("overflow",""):t.overflow="",d("html").css(t)}p.off("keyup.mfp focusin"+v),u.ev.off(v),u.wrap.attr("class","mfp-wrap").removeAttr("style"),u.bgOverlay.attr("class","mfp-bg"),u.container.attr("class","mfp-container"),!u.st.showCloseBtn||u.st.closeBtnInside&&!0!==u.currTemplate[u.currItem.type]||u.currTemplate.closeBtn&&u.currTemplate.closeBtn.detach(),u.st.autoFocusLast&&u._lastFocusedEl&&d(u._lastFocusedEl).focus(),u.currItem=null,u.content=null,u.currTemplate=null,u.prevHeight=0,w("AfterClose")},updateSize:function(e){if(u.isIOS){var t=document.documentElement.clientWidth/window.innerWidth,a=window.innerHeight*t;u.wrap.css("height",a),u.wH=a}else u.wH=e||y.height();u.fixedContentPos||u.wrap.css("height",u.wH),w("Resize")},updateItemHTML:function(){var e=u.items[u.index];u.contentContainer.detach(),u.content&&u.content.detach(),e.parsed||(e=u.parseEl(u.index));var t=e.type;if(w("BeforeChange",[u.currItem?u.currItem.type:"",t]),u.currItem=e,!u.currTemplate[t]){var a=!!u.st[t]&&u.st[t].markup;w("FirstMarkupParse",a),u.currTemplate[t]=!a||d(a)}i&&i!==e.type&&u.container.removeClass("mfp-"+i+"-holder");var n=u["get"+t.charAt(0).toUpperCase()+t.slice(1)](e,u.currTemplate[t]);u.appendContent(n,t),e.preloaded=!0,w("Change",e),i=e.type,u.container.prepend(u.contentContainer),w("AfterChange")},appendContent:function(e,t){(u.content=e)?u.st.showCloseBtn&&u.st.closeBtnInside&&!0===u.currTemplate[t]?u.content.find(".mfp-close").length||u.content.append(C()):u.content=e:u.content="",w("BeforeAppend"),u.container.addClass("mfp-"+t+"-holder"),u.contentContainer.append(u.content)},parseEl:function(e){var t,a=u.items[e];if(a.tagName?a={el:d(a)}:(t=a.type,a={data:a,src:a.src}),a.el){for(var n=u.types,i=0;i<n.length;i++)if(a.el.hasClass("mfp-"+n[i])){t=n[i];break}a.src=a.el.attr("data-mfp-src"),a.src||(a.src=a.el.attr("href"))}return a.type=t||u.st.type||"inline",a.index=e,a.parsed=!0,u.items[e]=a,w("ElementParse",a),u.items[e]},addGroup:function(t,a){var e=function(e){e.mfpEl=this,u._openClick(e,t,a)};a||(a={});var n="click.magnificPopup";a.mainEl=t,a.items?(a.isObj=!0,t.off(n).on(n,e)):(a.isObj=!1,a.delegate?t.off(n).on(n,a.delegate,e):(a.items=t).off(n).on(n,e))},_openClick:function(e,t,a){if((void 0!==a.midClick?a.midClick:d.magnificPopup.defaults.midClick)||!(2===e.which||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){var n=void 0!==a.disableOn?a.disableOn:d.magnificPopup.defaults.disableOn;if(n)if(d.isFunction(n)){if(!n.call(u))return!0}else if(y.width()<n)return!0;e.type&&(e.preventDefault(),u.isOpen&&e.stopPropagation()),a.el=d(e.mfpEl),a.delegate&&(a.items=t.find(a.delegate)),u.open(a)}},updateStatus:function(e,t){if(u.preloader){n!==e&&u.container.removeClass("mfp-s-"+n),t||"loading"!==e||(t=u.st.tLoading);var a={status:e,text:t};w("UpdateStatus",a),e=a.status,t=a.text,u.preloader.html(t),u.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),u.container.addClass("mfp-s-"+e),n=e}},_checkIfClose:function(e){if(!d(e).hasClass(s)){var t=u.st.closeOnContentClick,a=u.st.closeOnBgClick;if(t&&a)return!0;if(!u.content||d(e).hasClass("mfp-close")||u.preloader&&e===u.preloader[0])return!0;if(e===u.content[0]||d.contains(u.content[0],e)){if(t)return!0}else if(a&&d.contains(document,e))return!0;return!1}},_addClassToMFP:function(e){u.bgOverlay.addClass(e),u.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),u.wrap.removeClass(e)},_hasScrollBar:function(e){return(u.isIE7?p.height():document.body.scrollHeight)>(e||y.height())},_setFocus:function(){(u.st.focus?u.content.find(u.st.focus).eq(0):u.wrap).focus()},_onFocusIn:function(e){return e.target===u.wrap[0]||d.contains(u.wrap[0],e.target)?void 0:(u._setFocus(),!1)},_parseMarkup:function(i,e,t){var o;t.data&&(e=d.extend(t.data,e)),w(m,[i,e,t]),d.each(e,function(e,t){if(void 0===t||!1===t)return!0;if(1<(o=e.split("_")).length){var a=i.find(v+"-"+o[0]);if(0<a.length){var n=o[1];"replaceWith"===n?a[0]!==t[0]&&a.replaceWith(t):"img"===n?a.is("img")?a.attr("src",t):a.replaceWith('<img src="'+t+'" class="'+a.attr("class")+'" />'):a.attr(o[1],t)}}else i.find(v+"-"+e).html(t)})},_getScrollbarSize:function(){if(void 0===u.scrollbarSize){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),u.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return u.scrollbarSize}},d.magnificPopup={instance:null,proto:e.prototype,modules:[],open:function(e,t){return o(),(e=e?d.extend(!0,{},e):{}).isObj=!0,e.index=t||0,this.instance.open(e)},close:function(){return d.magnificPopup.instance&&d.magnificPopup.instance.close()},registerModule:function(e,t){t.options&&(d.magnificPopup.defaults[e]=t.options),d.extend(this.proto,t.proto),this.modules.push(e)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0}},d.fn.magnificPopup=function(e){o();var t=d(this);if("string"==typeof e)if("open"===e){var a,n=r?t.data("magnificPopup"):t[0].magnificPopup,i=parseInt(arguments[1],10)||0;n.items?a=n.items[i]:(a=t,n.delegate&&(a=a.find(n.delegate)),a=a.eq(i)),u._openClick({mfpEl:a},t,n)}else u.isOpen&&u[e].apply(u,Array.prototype.slice.call(arguments,1));else e=d.extend(!0,{},e),r?t.data("magnificPopup",e):t[0].magnificPopup=e,u.addGroup(t,e);return t};var x,A,$,E="inline",T=function(){$&&(A.after($.addClass(x)).detach(),$=null)};d.magnificPopup.registerModule(E,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){u.types.push(E),b(l+"."+E,function(){T()})},getInline:function(e,t){if(T(),e.src){var a=u.st.inline,n=d(e.src);if(n.length){var i=n[0].parentNode;i&&i.tagName&&(A||(x=a.hiddenClass,A=k(x),x="mfp-"+x),$=n.after(A).detach().removeClass(x)),u.updateStatus("ready")}else u.updateStatus("error",a.tNotFound),n=d("<div>");return e.inlineElement=n}return u.updateStatus("ready"),u._parseMarkup(t,{},e),t}}});var I,S="ajax",O=function(){I&&d(document.body).removeClass(I)},L=function(){O(),u.req&&u.req.abort()};d.magnificPopup.registerModule(S,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){u.types.push(S),I=u.st.ajax.cursor,b(l+"."+S,L),b("BeforeChange."+S,L)},getAjax:function(i){I&&d(document.body).addClass(I),u.updateStatus("loading");var e=d.extend({url:i.src,success:function(e,t,a){var n={data:e,xhr:a};w("ParseAjax",n),u.appendContent(d(n.data),S),i.finished=!0,O(),u._setFocus(),setTimeout(function(){u.wrap.addClass(g)},16),u.updateStatus("ready"),w("AjaxContentAdded")},error:function(){O(),i.finished=i.loadError=!0,u.updateStatus("error",u.st.ajax.tError.replace("%url%",i.src))}},u.st.ajax.settings);return u.req=d.ajax(e),""}}});var P;d.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var e=u.st.image,t=".image";u.types.push("image"),b(h+t,function(){"image"===u.currItem.type&&e.cursor&&d(document.body).addClass(e.cursor)}),b(l+t,function(){e.cursor&&d(document.body).removeClass(e.cursor),y.off("resize"+v)}),b("Resize"+t,u.resizeImage),u.isLowIE&&b("AfterChange",u.resizeImage)},resizeImage:function(){var e=u.currItem;if(e&&e.img&&u.st.image.verticalFit){var t=0;u.isLowIE&&(t=parseInt(e.img.css("padding-top"),10)+parseInt(e.img.css("padding-bottom"),10)),e.img.css("max-height",u.wH-t)}},_onImageHasSize:function(e){e.img&&(e.hasSize=!0,P&&clearInterval(P),e.isCheckingImgSize=!1,w("ImageHasSize",e),e.imgHidden&&(u.content&&u.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(t){var a=0,n=t.img[0],i=function(e){P&&clearInterval(P),P=setInterval(function(){return 0<n.naturalWidth?void u._onImageHasSize(t):(200<a&&clearInterval(P),void(3===++a?i(10):40===a?i(50):100===a&&i(500)))},e)};i(1)},getImage:function(e,t){var a=0,n=function(){e&&(e.img[0].complete?(e.img.off(".mfploader"),e===u.currItem&&(u._onImageHasSize(e),u.updateStatus("ready")),e.hasSize=!0,e.loaded=!0,w("ImageLoadComplete")):++a<200?setTimeout(n,100):i())},i=function(){e&&(e.img.off(".mfploader"),e===u.currItem&&(u._onImageHasSize(e),u.updateStatus("error",o.tError.replace("%url%",e.src))),e.hasSize=!0,e.loaded=!0,e.loadError=!0)},o=u.st.image,s=t.find(".mfp-img");if(s.length){var r=document.createElement("img");r.className="mfp-img",e.el&&e.el.find("img").length&&(r.alt=e.el.find("img").attr("alt")),e.img=d(r).on("load.mfploader",n).on("error.mfploader",i),r.src=e.src,s.is("img")&&(e.img=e.img.clone()),0<(r=e.img[0]).naturalWidth?e.hasSize=!0:r.width||(e.hasSize=!1)}return u._parseMarkup(t,{title:function(e){if(e.data&&void 0!==e.data.title)return e.data.title;var t=u.st.image.titleSrc;if(t){if(d.isFunction(t))return t.call(u,e);if(e.el)return e.el.attr(t)||""}return""}(e),img_replaceWith:e.img},e),u.resizeImage(),e.hasSize?(P&&clearInterval(P),e.loadError?(t.addClass("mfp-loading"),u.updateStatus("error",o.tError.replace("%url%",e.src))):(t.removeClass("mfp-loading"),u.updateStatus("ready"))):(u.updateStatus("loading"),e.loading=!0,e.hasSize||(e.imgHidden=!0,t.addClass("mfp-loading"),u.findImageSize(e))),t}}});var K;d.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,o=u.st.zoom,t=".zoom";if(o.enabled&&u.supportsTransition){var a,n,i=o.duration,s=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),a="all "+o.duration/1e3+"s "+o.easing,n={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},i="transition";return n["-webkit-"+i]=n["-moz-"+i]=n["-o-"+i]=n[i]=a,t.css(n),t},r=function(){u.content.css("visibility","visible")};b("BuildControls"+t,function(){if(u._allowZoom()){if(clearTimeout(a),u.content.css("visibility","hidden"),!(e=u._getItemToZoom()))return void r();(n=s(e)).css(u._getOffset()),u.wrap.append(n),a=setTimeout(function(){n.css(u._getOffset(!0)),a=setTimeout(function(){r(),setTimeout(function(){n.remove(),e=n=null,w("ZoomAnimationEnded")},16)},i)},16)}}),b(c+t,function(){if(u._allowZoom()){if(clearTimeout(a),u.st.removalDelay=i,!e){if(!(e=u._getItemToZoom()))return;n=s(e)}n.css(u._getOffset(!0)),u.wrap.append(n),u.content.css("visibility","hidden"),setTimeout(function(){n.css(u._getOffset())},16)}}),b(l+t,function(){u._allowZoom()&&(r(),n&&n.remove(),e=null)})}},_allowZoom:function(){return"image"===u.currItem.type},_getItemToZoom:function(){return!!u.currItem.hasSize&&u.currItem.img},_getOffset:function(e){var t,a=(t=e?u.currItem.img:u.st.zoom.opener(u.currItem.el||u.currItem)).offset(),n=parseInt(t.css("padding-top"),10),i=parseInt(t.css("padding-bottom"),10);a.top-=d(window).scrollTop()-n;var o={width:t.width(),height:(r?t.innerHeight():t[0].offsetHeight)-i-n};return void 0===K&&(K=void 0!==document.createElement("p").style.MozTransform),K?o["-moz-transform"]=o.transform="translate("+a.left+"px,"+a.top+"px)":(o.left=a.left,o.top=a.top),o}}});var B="iframe",_=function(e){if(u.currTemplate[B]){var t=u.currTemplate[B].find("iframe");t.length&&(e||(t[0].src="//about:blank"),u.isIE8&&t.css("display",e?"block":"none"))}};d.magnificPopup.registerModule(B,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){u.types.push(B),b("BeforeChange",function(e,t,a){t!==a&&(t===B?_():a===B&&_(!0))}),b(l+"."+B,function(){_()})},getIframe:function(e,t){var a=e.src,n=u.st.iframe;d.each(n.patterns,function(){return-1<a.indexOf(this.index)?(this.id&&(a="string"==typeof this.id?a.substr(a.lastIndexOf(this.id)+this.id.length,a.length):this.id.call(this,a)),a=this.src.replace("%id%",a),!1):void 0});var i={};return n.srcAction&&(i[n.srcAction]=a),u._parseMarkup(t,i,e),u.updateStatus("ready"),t}}});var M=function(e){var t=u.items.length;return t-1<e?e-t:e<0?t+e:e},N=function(e,t,a){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,a)};d.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var o=u.st.gallery,e=".mfp-gallery",i=Boolean(d.fn.mfpFastClick);return u.direction=!0,!(!o||!o.enabled)&&(f+=" mfp-gallery",b(h+e,function(){o.navigateByImgClick&&u.wrap.on("click"+e,".mfp-img",function(){return 1<u.items.length?(u.next(),!1):void 0}),p.on("keydown"+e,function(e){37===e.keyCode?u.prev():39===e.keyCode&&u.next()})}),b("UpdateStatus"+e,function(e,t){t.text&&(t.text=N(t.text,u.currItem.index,u.items.length))}),b(m+e,function(e,t,a,n){var i=u.items.length;a.counter=1<i?N(o.tCounter,n.index,i):""}),b("BuildControls"+e,function(){if(1<u.items.length&&o.arrows&&!u.arrowLeft){var e=o.arrowMarkup,t=u.arrowLeft=d(e.replace(/%title%/gi,o.tPrev).replace(/%dir%/gi,"left")).addClass(s),a=u.arrowRight=d(e.replace(/%title%/gi,o.tNext).replace(/%dir%/gi,"right")).addClass(s),n=i?"mfpFastClick":"click";t[n](function(){u.prev()}),a[n](function(){u.next()}),u.isIE7&&(k("b",t[0],!1,!0),k("a",t[0],!1,!0),k("b",a[0],!1,!0),k("a",a[0],!1,!0)),u.container.append(t.add(a))}}),b("Change"+e,function(){u._preloadTimeout&&clearTimeout(u._preloadTimeout),u._preloadTimeout=setTimeout(function(){u.preloadNearbyImages(),u._preloadTimeout=null},16)}),void b(l+e,function(){p.off(e),u.wrap.off("click"+e),u.arrowLeft&&i&&u.arrowLeft.add(u.arrowRight).destroyMfpFastClick(),u.arrowRight=u.arrowLeft=null}))},next:function(){u.direction=!0,u.index=M(u.index+1),u.updateItemHTML()},prev:function(){u.direction=!1,u.index=M(u.index-1),u.updateItemHTML()},goTo:function(e){u.direction=e>=u.index,u.index=e,u.updateItemHTML()},preloadNearbyImages:function(){var e,t=u.st.gallery.preload,a=Math.min(t[0],u.items.length),n=Math.min(t[1],u.items.length);for(e=1;e<=(u.direction?n:a);e++)u._preloadItem(u.index+e);for(e=1;e<=(u.direction?a:n);e++)u._preloadItem(u.index-e)},_preloadItem:function(e){if(e=M(e),!u.items[e].preloaded){var t=u.items[e];t.parsed||(t=u.parseEl(e)),w("LazyLoad",t),"image"===t.type&&(t.img=d('<img class="mfp-img" />').on("load.mfploader",function(){t.hasSize=!0}).on("error.mfploader",function(){t.hasSize=!0,t.loadError=!0,w("LazyLoadError",t)}).attr("src",t.src)),t.preloaded=!0}}}});var F,D,R,V="retina";d.magnificPopup.registerModule(V,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){if(1<window.devicePixelRatio){var a=u.st.retina,n=a.ratio;1<(n=isNaN(n)?n():n)&&(b("ImageHasSize."+V,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/n,width:"100%"})}),b("ElementParse."+V,function(e,t){t.src=a.replaceSrc(t,n)}))}}}}),F="ontouchstart"in window,D=function(){y.off("touchmove"+R+" touchend"+R)},R=".mfpFastClick",d.fn.mfpFastClick=function(l){return d(this).each(function(){var t,a,n,i,o,s,r,e=d(this);F&&e.on("touchstart"+R,function(e){o=!1,r=1,s=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],n=s.clientX,i=s.clientY,y.on("touchmove"+R,function(e){s=e.originalEvent?e.originalEvent.touches:e.touches,r=s.length,s=s[0],(10<Math.abs(s.clientX-n)||10<Math.abs(s.clientY-i))&&(o=!0,D())}).on("touchend"+R,function(e){D(),o||1<r||(t=!0,e.preventDefault(),clearTimeout(a),a=setTimeout(function(){t=!1},1e3),l())})}),e.on("click"+R,function(){t||l()})})},d.fn.destroyMfpFastClick=function(){d(this).off("touchstart"+R+" click"+R),F&&y.off("touchmove"+R+" touchend"+R)},o()}),function(a){a.fn.equalHeights=function(){var t=0,e=a(this);return e.each(function(){var e=a(this).innerHeight();t<e&&(t=e)}),e.css("height",t)},a("[data-equal]").each(function(){var e=a(this),t=e.data("equal");e.find(t).equalHeights()})}(jQuery);var Util=function(n){var t="transitionend";function e(e){var t=this,a=!1;return n(this).one(l.TRANSITION_END,function(){a=!0}),setTimeout(function(){a||l.triggerTransitionEnd(t)},e),this}var l={TRANSITION_END:"bsTransitionEnd",getUID:function(e){for(;e+=~~(1e6*Math.random()),document.getElementById(e););return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");t&&"#"!==t||(t=e.getAttribute("href")||"");try{return 0<n(document).find(t).length?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=n(e).css("transition-duration");return parseFloat(t)?(t=t.split(",")[0],1e3*parseFloat(t)):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){n(e).trigger(t)},supportsTransitionEnd:function(){return Boolean(t)},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,a){for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n)){var i=a[n],o=t[n],s=o&&l.isElement(o)?"element":(r=o,{}.toString.call(r).match(/\s([a-z]+)/i)[1].toLowerCase());if(!new RegExp(i).test(s))throw new Error(e.toUpperCase()+': Option "'+n+'" provided type "'+s+'" but expected type "'+i+'".')}var r}};return n.fn.emulateTransitionEnd=e,n.event.special[l.TRANSITION_END]={bindType:t,delegateType:t,handle:function(e){if(n(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},l}($);!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(m){"use strict";var h=m.keyboard=function(c,s){var p,f=this;f.version="1.28.5",f.$el=m(c),f.el=c,f.$el.data("keyboard",f),f.init=function(){f.initialized=!1;var e,t,a,n=h.css,i=h.events;f.settings=s||{},s&&s.position&&(t=m.extend({},s.position),s.position=null),f.options=p=m.extend(!0,{},h.defaultOptions,s),t&&(p.position=t,s.position=t),f.el.active=!0,f.namespace=".keyboard"+Math.random().toString(16).slice(2),f.extensionNamespace=[],f.shiftActive=f.altActive=f.metaActive=f.sets=f.capsLock=!1,f.rows=["","-shift","-alt","-alt-shift"],f.inPlaceholder=f.$el.attr("placeholder")||"",f.watermark=h.watermark&&""!==f.inPlaceholder,f.repeatTime=1e3/(p.repeatRate||20),p.preventDoubleEventTime=p.preventDoubleEventTime||100,f.isOpen=!1,f.wheel=m.isFunction(m.fn.mousewheel),f.escapeRegex=/[-\/\\^$*+?.()|[\]{}]/g,f.isContentEditable=!/(input|textarea)/i.test(f.el.nodeName)&&f.el.isContentEditable,e=h.keyCodes,f.alwaysAllowed=[e.capsLock,e.pageUp,e.pageDown,e.end,e.home,e.left,e.up,e.right,e.down,e.insert,e.delete],f.$keyboard=[],f.enabled=!0,f.checkCaret=p.lockInput||h.checkCaretSupport(),f.isContentEditable&&(p.usePreview=!1),f.last={start:0,end:0,key:"",val:"",preVal:"",layout:"",virtual:!0,keyset:[!1,!1,!1],wheel_$Keys:[],wheelIndex:0,wheelLayers:[]},f.temp=["",0,0],m.each([i.kbInit,i.kbBeforeVisible,i.kbVisible,i.kbHidden,i.inputCanceled,i.inputAccepted,i.kbBeforeClose,i.inputRestricted],function(e,t){m.isFunction(p[t])&&f.$el.bind(t+f.namespace+"callbacks",p[t])}),p.alwaysOpen&&(p.stayOpen=!0),a=m(document),f.el.ownerDocument!==document&&(a=a.add(f.el.ownerDocument));var o="keyup checkkeyboard mousedown touchstart ";p.closeByClickEvent&&(o+="click "),a.bind(o.split(" ").join(f.namespace+" "),function(e){clearTimeout(f.timer3),f.timer3=setTimeout(function(){f.checkClose(e)},1)}),f.$el.addClass(n.input+" "+p.css.input).attr({"aria-haspopup":"true",role:"textbox"}),(p.lockInput||f.el.readOnly)&&(p.lockInput=!0,f.$el.addClass(n.locked).attr({readonly:"readonly"})),f.isUnavailable()&&f.$el.addClass(n.noKeyboard),p.openOn&&f.bindFocus(),f.watermark||""!==f.getValue(f.$el)||""===f.inPlaceholder||""===f.$el.attr("placeholder")||(f.$el.addClass(n.placeholder),f.setValue(f.inPlaceholder,f.$el)),f.$el.trigger(i.kbInit,[f,f.el]),p.alwaysOpen&&f.reveal(),f.initialized=!0},f.toggle=function(){if(f.hasKeyboard()){var e=f.$keyboard.find("."+h.css.keyToggle),t=!f.enabled;return f.preview.readonly=t||f.options.lockInput,f.$keyboard.toggleClass(h.css.keyDisabled,t).find("."+h.css.keyButton).not(e).attr("aria-disabled",t).each(function(){this.disabled=t}),e.toggleClass(h.css.keyDisabled,t),t&&f.typing_options&&(f.typing_options.text=""),f}},f.setCurrent=function(){var e=h.css,t=m("."+e.isCurrent),a=t.data("keyboard");m.isEmptyObject(a)||a.el===f.el||a.close(!!a.options.autoAccept&&"true"),t.removeClass(e.isCurrent),m("."+e.hasFocus).removeClass(e.hasFocus),f.$el.addClass(e.isCurrent),f.$keyboard.addClass(e.hasFocus),f.isCurrent(!0),f.isOpen=!0},f.isUnavailable=function(){return f.$el.is(":disabled")||!f.options.activeOnReadonly&&f.$el.attr("readonly")&&!f.$el.hasClass(h.css.locked)},f.isCurrent=function(e){var t=h.currentKeyboard||!1;return e?t=h.currentKeyboard=f.el:!1===e&&t===f.el&&(t=h.currentKeyboard=""),t===f.el},f.hasKeyboard=function(){return f.$keyboard&&0<f.$keyboard.length},f.isVisible=function(){return!!f.hasKeyboard()&&f.$keyboard.is(":visible")},f.setFocus=function(){var e=f.$preview||f.$el;p.noFocus||e.focus(),f.isContentEditable?h.setEditableCaret(e,f.last.start,f.last.end):h.caret(e,f.last)},f.focusOn=function(){!f&&f.el.active||(f.isVisible()?f.setCurrent():(clearTimeout(f.timer),f.reveal()))},f.redraw=function(e){return e&&(f.options.layout=e),f.$keyboard.length&&(f.last.preVal=""+f.last.val,f.saveLastChange(),f.setValue(f.last.val,f.$el),f.removeKeyboard(),f.shiftActive=f.altActive=f.metaActive=!1),f.isOpen=p.alwaysOpen,f.reveal(!0),f},f.reveal=function(e){var t,a=f.isOpen,n=h.css;if(f.opening=!a,m("."+n.keyboard).not("."+n.alwaysOpen).each(function(){var e=m(this).data("keyboard");m.isEmptyObject(e)||e.close(!!e.options.autoAccept&&"true")}),!f.isUnavailable())return f.$el.removeClass(n.noKeyboard),p.openOn&&f.$el.unbind(m.trim((p.openOn+" ").split(/\s+/).join(f.namespace+" "))),f.$keyboard&&(!f.$keyboard||f.$keyboard.length&&!m.contains(f.el.ownerDocument.body,f.$keyboard[0]))||f.startup(),f.watermark||f.getValue()!==f.inPlaceholder||(f.$el.removeClass(n.placeholder),f.setValue("",f.$el)),f.originalContent=f.isContentEditable?f.$el.html():f.getValue(f.$el),f.el===f.preview||f.isContentEditable||f.setValue(f.originalContent),p.acceptValid&&p.checkValidOnInit&&f.checkValid(),p.resetDefault&&(f.shiftActive=f.altActive=f.metaActive=!1),f.showSet(),f.isVisible()||f.$el.trigger(h.events.kbBeforeVisible,[f,f.el]),(f.initialized||p.initialFocus||!p.initialFocus&&f.$el.hasClass(h.css.initialFocus))&&f.setCurrent(),f.toggle(),f.$keyboard.show(),p.usePreview&&h.msie&&(void 0===f.width&&(f.$preview.hide(),f.width=Math.ceil(f.$keyboard.width()),f.$preview.show()),f.$preview.width(f.width)),f.reposition(),f.checkDecimal(),f.lineHeight=parseInt(f.$preview.css("lineHeight"),10)||parseInt(f.$preview.css("font-size"),10)+4,p.caretToEnd&&(t=f.isContentEditable?h.getEditableLength(f.el):f.originalContent.length,f.saveCaret(t,t)),h.allie&&(0===f.last.end&&0<f.last.start&&(f.last.end=f.last.start),f.last.start<0&&(f.last.start=f.last.end=f.originalContent.length)),a||e?(h.caret(f.$preview,f.last),f.opening=!1):f.timer2=setTimeout(function(){f.opening=!1,/(number|email)/i.test(f.el.type)||p.caretToEnd||f.saveCaret(void 0,void 0,f.$el),(p.initialFocus||f.$el.hasClass(h.css.initialFocus))&&h.caret(f.$preview,f.last),f.last.eventTime=(new Date).getTime(),f.$el.trigger(h.events.kbVisible,[f,f.el]),f.timer=setTimeout(function(){f&&f.saveCaret()},200)},10),f},f.updateLanguage=function(){var e=h.layouts,t=p.language||e[p.layout]&&e[p.layout].lang&&e[p.layout].lang||[p.language||"en"],a=h.language;t=m.isArray(t)?t[0]:t,t=(f.language=t).split("-")[0],p.display=m.extend(!0,{},a.en.display,a[t]&&a[t].display||{},f.settings.display),p.combos=m.extend(!0,{},a.en.combos,a[t]&&a[t].combos||{},f.settings.combos),p.wheelMessage=a[t]&&a[t].wheelMessage||a.en.wheelMessage,p.rtl=e[p.layout]&&e[p.layout].rtl||a[t]&&a[t].rtl||!1,f.regex=a[t]&&a[t].comboRegex||h.comboRegex,f.decimal=/^\./.test(p.display.dec),f.$el.toggleClass("rtl",p.rtl).css("direction",p.rtl?"rtl":"")},f.startup=function(){var e=h.css;(p.alwaysOpen||p.userClosed)&&f.$preview||f.makePreview(),f.hasKeyboard()||("custom"===p.layout&&(p.layoutHash="custom"+f.customHash()),f.layout="custom"===p.layout?p.layoutHash:p.layout,f.last.layout=f.layout,f.updateLanguage(),void 0===h.builtLayouts[f.layout]&&(m.isFunction(p.create)?f.$keyboard=p.create(f):f.$keyboard.length||f.buildKeyboard(f.layout,!0)),f.$keyboard=h.builtLayouts[f.layout].$keyboard.clone(),f.$keyboard.data("keyboard",f),""!==(f.el.id||"")&&f.$keyboard.attr("id",f.el.id+h.css.idSuffix),f.makePreview()),f.$keyboard.attr("data-"+e.keyboard+"-layout",p.layout).attr("data-"+e.keyboard+"-language",f.language),f.$decBtn=f.$keyboard.find("."+e.keyPrefix+"dec"),(p.enterNavigation||"TEXTAREA"===f.el.nodeName)&&f.alwaysAllowed.push(h.keyCodes.enter),f.bindKeyboard(),f.$keyboard.appendTo(p.appendLocally?f.$el.parent():p.appendTo||"body"),f.bindKeys(),p.reposition&&m.ui&&m.ui.position&&"body"===p.appendTo&&m(window).bind("resize"+f.namespace,function(){f.reposition()})},f.reposition=function(){return f.position=!m.isEmptyObject(p.position)&&p.position,m.ui&&m.ui.position&&f.position&&(f.position.of=f.position.of||f.$el.data("keyboardPosition")||f.$el,f.position.collision=f.position.collision||"flipfit flipfit",f.position.at=p.usePreview?p.position.at:p.position.at2,f.isVisible()&&f.$keyboard.position(f.position)),f},f.makePreview=function(){if(p.usePreview){var e,t,a,n,i=h.css;for(f.$preview=f.$el.clone(!1).data("keyboard",f).removeClass(i.placeholder+" "+i.input).addClass(i.preview+" "+p.css.input).attr("tabindex","-1").show(),f.preview=f.$preview[0],"number"===f.preview.type&&(f.preview.type="text"),n=/^(data-|id|aria-haspopup)/i,e=(t=f.$preview.get(0).attributes).length-1;0<=e;e--)a=t[e]&&t[e].name,n.test(a)&&f.preview.removeAttribute(a);m("<div />").addClass(i.wrapper).append(f.$preview).prependTo(f.$keyboard)}else f.$preview=f.$el,f.preview=f.el},f.caret=function(e,t){var a=h.caret(f.$preview,e,t);return a instanceof m?(f.saveCaret(a.start,a.end),f):a},f.saveCaret=function(e,t,a){var n;f.isCurrent()&&(n=void 0===e?h.caret(a||f.$preview):h.caret(a||f.$preview,e,t),f.last.start=void 0===e?n.start:e,f.last.end=void 0===t?n.end:t)},f.saveLastChange=function(e){f.last.val=e||f.getValue(f.$preview||f.$el),f.isContentEditable&&(f.last.elms=f.el.cloneNode(!0))},f.setScroll=function(){if(!f.isContentEditable&&f.last.virtual){var e,t,a,n,i="TEXTAREA"===f.preview.nodeName,o=f.last.val.substring(0,Math.max(f.last.start,f.last.end));f.$previewCopy||(f.$previewCopy=f.$preview.clone().removeAttr("id").css({position:"absolute",left:0,zIndex:-10,visibility:"hidden"}).addClass(h.css.inputClone),f.$previewCopy[0].disabled=!0,i||f.$previewCopy.css({"white-space":"pre",width:0}),p.usePreview?f.$preview.after(f.$previewCopy):f.$keyboard.prepend(f.$previewCopy)),i?(f.$previewCopy.height(f.lineHeight).val(o),f.preview.scrollTop=f.lineHeight*(Math.floor(f.$previewCopy[0].scrollHeight/f.lineHeight)-1)):(f.$previewCopy.val(o.replace(/\s/g," ")),a=/c/i.test(p.scrollAdjustment)?f.preview.clientWidth/2:p.scrollAdjustment,e=f.$previewCopy[0].scrollWidth-1,void 0===f.last.scrollWidth&&(f.last.scrollWidth=e,f.last.direction=!0),n=f.last.scrollWidth===e?f.last.direction:f.last.scrollWidth<e,t=f.preview.clientWidth-a,n?f.preview.scrollLeft=e<t?0:e-t:e>=f.preview.scrollWidth-t?f.preview.scrollLeft=f.preview.scrollWidth-a:f.preview.scrollLeft=0<e-a?e-a:0,f.last.scrollWidth=e,f.last.direction=n)}},f.bindFocus=function(){p.openOn&&f&&f.el.active&&(f.$el.bind(p.openOn+f.namespace,function(){f.focusOn()}),m(":focus")[0]===f.el&&f.$el.blur())},f.bindKeyboard=function(){var o,s=h.keyCodes,r=h.builtLayouts[f.layout],e=f.namespace+"keybindings";f.$preview.unbind(f.namespace).bind("click"+e+" touchstart"+e,function(){p.alwaysOpen&&!f.isCurrent()&&f.reveal(),f.timer2=setTimeout(function(){f&&f.saveCaret()},150)}).bind("keypress"+e,function(e){if(p.lockInput)return!1;if(f.isCurrent()){var t=e.charCode||e.which,a=t>=s.A&&t<=s.Z,n=t>=s.a&&t<=s.z,i=f.last.key=String.fromCharCode(t);if(!(t<s.space)){if(f.last.virtual=!1,f.last.event=e,f.last.$key=[],f.checkCaret&&f.saveCaret(),t!==s.capsLock&&(a||n)&&(f.capsLock=a&&!e.shiftKey||n&&e.shiftKey,f.capsLock&&!f.shiftActive&&(f.shiftActive=!0,f.showSet())),p.restrictInput){if((e.which===s.backSpace||0===e.which)&&m.inArray(e.keyCode,f.alwaysAllowed))return;-1===m.inArray(i,r.acceptedKeys)&&(e.preventDefault(),(o=m.extend({},e)).type=h.events.inputRestricted,f.$el.trigger(o,[f,f.el]))}else if((e.ctrlKey||e.metaKey)&&(e.which===s.A||e.which===s.C||e.which===s.V||e.which>=s.X&&e.which<=s.Z))return;r.hasMappedKeys&&r.mappedKeys.hasOwnProperty(i)&&(f.last.key=r.mappedKeys[i],f.insertText(f.last.key),e.preventDefault()),"function"==typeof p.beforeInsert&&(f.insertText(f.last.key),e.preventDefault()),f.checkMaxLength()}}}).bind("keyup"+e,function(e){if(f.isCurrent()){switch(f.last.virtual=!1,e.which){case s.tab:if(f.tab&&p.tabNavigation&&!p.lockInput){f.shiftActive=e.shiftKey;var t=h.keyaction.tab(f);if(f.tab=!1,!t)return!1}else e.preventDefault();break;case s.escape:return p.ignoreEsc||f.close(!(!p.autoAccept||!p.autoAcceptOnEsc)&&"true"),!1}clearTimeout(f.throttled),f.throttled=setTimeout(function(){f&&f.isVisible()&&f.checkCombos()},100),f.checkMaxLength(),f.last.preVal=""+f.last.val,f.saveLastChange();var a=m.Event(h.events.kbChange);if(a.action=f.last.key,f.$el.trigger(a,[f,f.el]),m.isFunction(p.change))return a.type=h.events.inputChange,p.change(a,f,f.el),!1;p.acceptValid&&p.autoAcceptOnValid&&m.isFunction(p.validate)&&p.validate(f,f.getValue(f.$preview))&&(f.$preview.blur(),f.accept())}}).bind("keydown"+e,function(e){if(f.last.keyPress=e.which,p.alwaysOpen&&!f.isCurrent()&&f.reveal(),e.which===s.tab)return!(f.tab=!0);if(p.lockInput||e.timeStamp===f.last.timeStamp)return!p.lockInput;switch(f.last.timeStamp=e.timeStamp,f.last.virtual=!1,e.which){case s.backSpace:h.keyaction.bksp(f,null,e),e.preventDefault();break;case s.enter:h.keyaction.enter(f,null,e);break;case s.capsLock:f.shiftActive=f.capsLock=!f.capsLock,f.showSet();break;case s.V:if(e.ctrlKey||e.metaKey){if(p.preventPaste)return void e.preventDefault();f.checkCombos()}}}).bind("mouseup touchend ".split(" ").join(e+" "),function(){f.last.virtual=!0,f.saveCaret()}),f.$keyboard.bind("mousedown click touchstart ".split(" ").join(f.namespace+" "),function(e){e.stopPropagation(),f.isCurrent()||(f.reveal(),m(f.el.ownerDocument).trigger("checkkeyboard"+f.namespace)),f.setFocus()}),p.preventPaste&&(f.$preview.bind("contextmenu"+f.namespace,function(e){e.preventDefault()}),f.$el.bind("contextmenu"+f.namespace,function(e){e.preventDefault()}))},f.bindButton=function(e,t){var a="."+h.css.keyButton,n=function(e){e.stopPropagation(),e.$target=m(this).closest("."+h.css.keyboard+", ."+h.css.input),t.call(this,e)};return m.fn.on?f.$keyboard.on(e,a,n):m.fn.delegate&&f.$keyboard.delegate(a,e,n),f},f.unbindButton=function(e){return m.fn.off?f.$keyboard.off(e):m.fn.undelegate&&f.$keyboard.undelegate("."+h.css.keyButton,e),f},f.bindKeys=function(){var o=h.css;f.unbindButton(f.namespace+" "+f.namespace+"kb").bindButton("mouseenter mouseleave touchstart ".split(" ").join(f.namespace+" "),function(e){if(!p.alwaysOpen&&!p.userClosed||"mouseleave"===e.type||f.isCurrent()||(f.reveal(),f.setFocus()),f.isCurrent()&&!this.disabled){var t,a,n=f.last,i=m(this),o=e.type;p.useWheel&&f.wheel&&(t=f.getLayers(i),a=(t.length?t.map(function(){return m(this).attr("data-value")||""}).get():"")||[i.text()],n.wheel_$Keys=t,n.wheelLayers=a,n.wheelIndex=m.inArray(i.attr("data-value"),a)),"mouseenter"!==o&&"touchstart"!==o||"password"===f.el.type||i.hasClass(p.css.buttonDisabled)||(i.addClass(p.css.buttonHover),p.useWheel&&f.wheel&&i.attr("title",function(e,t){return f.wheel&&""===t&&f.sets&&1<a.length&&"touchstart"!==o?p.wheelMessage:t})),"mouseleave"===o&&(i.removeClass("password"===f.el.type?"":p.css.buttonHover),p.useWheel&&f.wheel&&(n.wheelIndex=0,n.wheelLayers=[],n.wheel_$Keys=[],i.attr("title",function(e,t){return t===p.wheelMessage?"":t}).html(i.attr("data-html"))))}}).bindButton(p.keyBinding.split(" ").join(f.namespace+" ")+f.namespace+" "+h.events.kbRepeater,function(e){if(e.preventDefault(),!f.$keyboard.is(":visible")||this.disabled)return!1;var t,a=f.last,n=m(this),i=(new Date).getTime();if(p.useWheel&&f.wheel&&(n=a.wheel_$Keys&&-1<a.wheelIndex?a.wheel_$Keys.eq(a.wheelIndex):n),t=n.attr("data-action"),!(i-(a.eventTime||0)<p.preventDoubleEventTime)){if(a.eventTime=i,a.event=e,a.virtual=!0,a.$key=n,a.key=n.attr("data-value"),a.keyPress="",f.setFocus(),/^meta/.test(t)&&(t="meta"),t===a.key&&"string"==typeof h.keyaction[t])a.key=t=h.keyaction[t];else if(t in h.keyaction&&m.isFunction(h.keyaction[t])){if(!1===h.keyaction[t](f,this,e))return!1;t=null}return!!f.hasKeyboard()&&(null!=t&&(a.key=m(this).hasClass(o.keyAction)?t:a.key,f.insertText(a.key),f.capsLock||p.stickyShift||e.shiftKey||(f.shiftActive=!1,f.showSet(n.attr("data-name")))),h.caret(f.$preview,a),f.checkCombos(),(e=m.extend({},e,m.Event(h.events.kbChange))).target=f.el,e.action=a.key,f.$el.trigger(e,[f,f.el]),a.preVal=""+a.val,f.saveLastChange(),m.isFunction(p.change)?(e.type=h.events.inputChange,p.change(e,f,f.el),!1):void 0)}}).bindButton("mouseup"+f.namespace+" "+"mouseleave touchend touchmove touchcancel ".split(" ").join(f.namespace+"kb "),function(e){f.last.virtual=!0;var t,a=m(this);if("touchmove"===e.type){if((t=a.offset()).right=t.left+a.outerWidth(),t.bottom=t.top+a.outerHeight(),e.originalEvent.touches[0].pageX>=t.left&&e.originalEvent.touches[0].pageX<t.right&&e.originalEvent.touches[0].pageY>=t.top&&e.originalEvent.touches[0].pageY<t.bottom)return!0}else/(mouseleave|touchend|touchcancel)/i.test(e.type)?a.removeClass(p.css.buttonHover):(!p.noFocus&&f.isCurrent()&&f.isVisible()&&f.$preview.focus(),f.checkCaret&&h.caret(f.$preview,f.last));return f.mouseRepeat=[!1,""],clearTimeout(f.repeater),p.acceptValid&&p.autoAcceptOnValid&&m.isFunction(p.validate)&&p.validate(f,f.getValue())&&(f.$preview.blur(),f.accept()),!1}).bindButton("click"+f.namespace,function(){return!1}).bindButton("mousewheel"+f.namespace,f.throttleEvent(function(e,t){var a=m(this);if(a&&!a.hasClass(o.keyAction)&&f.last.wheel_$Keys[0]===this&&p.useWheel&&f.wheel){t=t||e.deltaY;var n,i=f.last.wheelLayers||[];return 1<i.length?((n=f.last.wheelIndex+(0<t?-1:1))>i.length-1&&(n=0),n<0&&(n=i.length-1)):n=0,f.last.wheelIndex=n,a.html(i[n]),!1}},30)).bindButton("mousedown touchstart ".split(" ").join(f.namespace+"kb "),function(){var e=m(this);if(e&&(!e.hasClass(o.keyAction)||e.is("."+o.keyPrefix+"tab bksp space enter".split(" ").join(",."+o.keyPrefix))))return 0!==p.repeatRate&&(f.mouseRepeat=[!0,e],setTimeout(function(){f&&f.mouseRepeat[0]&&f.mouseRepeat[1]===e&&!e[0].disabled&&f.repeatKey(e)},p.repeatDelay)),!1})},f.throttleEvent=function(e,t){var a;return function(){a||(e.apply(this,arguments),a=!0,setTimeout(function(){a=!1},t))}},f.execCommand=function(e,t){f.el.ownerDocument.execCommand(e,!1,t),f.el.normalize(),p.reposition&&f.reposition()},f.getValue=function(e){return(e=e||f.$preview)[f.isContentEditable?"text":"val"]()},f.setValue=function(e,t){return t=t||f.$preview,f.isContentEditable?e!==t.text()&&(h.replaceContent(t,e),f.saveCaret()):t.val(e),f},f.insertText=function(e){if(!f.$preview)return f;if("function"==typeof p.beforeInsert&&(e=p.beforeInsert(f.last.event,f,f.el,e)),void 0===e||!1===e)return f.last.key="",f;if(f.isContentEditable)return f.insertContentEditable(e);var t,a=!1,n="\b"===e,i=f.getValue(),o=h.caret(f.$preview),s=i.length;return o.end<o.start&&(o.end=o.start),o.start>s&&(o.end=o.start=s),"TEXTAREA"===f.preview.nodeName&&h.msie&&"\n"===i.substr(o.start,1)&&(o.start+=1,o.end+=1),t=o.start,"{d}"===e&&(e="",o.end+=1),n&&(e="",a=n&&t===o.end&&0<t),i=i.substr(0,t-(a?1:0))+e+i.substr(o.end),t+=a?-1:e.length,f.setValue(i),f.saveCaret(t,t),f.setScroll(),f},f.insertContentEditable=function(e){return f.$preview.focus(),f.execCommand("insertText",e),f.saveCaret(),f},f.checkMaxLength=function(){if(f.$preview){var e,t,a=f.getValue(),n=f.isContentEditable?h.getEditableLength(f.el):a.length;return!1!==p.maxLength&&n>p.maxLength&&(e=h.caret(f.$preview).start,t=Math.min(e,p.maxLength),p.maxInsert||(a=f.last.val,t=e-1),f.setValue(a.substring(0,p.maxLength)),f.saveCaret(t,t)),f.$decBtn.length&&f.checkDecimal(),f}},f.repeatKey=function(e){e.trigger(h.events.kbRepeater),f.mouseRepeat[0]&&(f.repeater=setTimeout(function(){f&&f.repeatKey(e)},f.repeatTime))},f.getKeySet=function(){var e=[];return f.altActive&&e.push("alt"),f.shiftActive&&e.push("shift"),f.metaActive&&e.push(f.metaActive),e.length?e.join("+"):"normal"},f.showKeySet=function(e){return"string"==typeof e?(f.last.keyset=[f.shiftActive,f.altActive,f.metaActive],f.shiftActive=/shift/i.test(e),f.altActive=/alt/i.test(e),/\bmeta/.test(e)?(f.metaActive=!0,f.showSet(e.match(/\bmeta[\w-]+/i)[0])):(f.metaActive=!1,f.showSet())):f.showSet(e),f},f.showSet=function(e){if(f.hasKeyboard()){p=f.options;var t=h.css,a="."+t.keyPrefix,n=p.css.buttonActive,i="",o=(f.shiftActive?1:0)+(f.altActive?2:0);if(f.shiftActive||(f.capsLock=!1),f.metaActive?(f.shiftActive&&(e=(e||"").replace("-shift","")),f.altActive&&(e=(e||"").replace("-alt","")),""===(i=/^meta/i.test(e)?e:"")?i=!0===f.metaActive?"":f.metaActive:f.metaActive=i,(!p.stickyShift&&f.last.keyset[2]!==f.metaActive||(f.shiftActive||f.altActive)&&!f.$keyboard.find("."+t.keySet+"-"+i+f.rows[o]).length)&&(f.shiftActive=f.altActive=!1)):!p.stickyShift&&f.last.keyset[2]!==f.metaActive&&f.shiftActive&&(f.shiftActive=f.altActive=!1),i=0!==(o=(f.shiftActive?1:0)+(f.altActive?2:0))||f.metaActive?""===i?"":"-"+i:"-normal",!f.$keyboard.find("."+t.keySet+i+f.rows[o]).length)return f.shiftActive=f.last.keyset[0],f.altActive=f.last.keyset[1],void(f.metaActive=f.last.keyset[2]);f.$keyboard.find(a+"alt,"+a+"shift,."+t.keyAction+"[class*=meta]").removeClass(n).end().find(a+"alt").toggleClass(n,f.altActive).end().find(a+"shift").toggleClass(n,f.shiftActive).end().find(a+"lock").toggleClass(n,f.capsLock).end().find("."+t.keySet).hide().end().find("."+(t.keyAction+a+i).replace("--","-")).addClass(n),f.$keyboard.find("."+t.keySet+i+f.rows[o])[0].style.display="inline-block",f.metaActive&&f.$keyboard.find(a+f.metaActive).toggleClass(n,!1!==f.metaActive),f.last.keyset=[f.shiftActive,f.altActive,f.metaActive],f.$el.trigger(h.events.kbKeysetChange,[f,f.el]),p.reposition&&f.reposition()}},f.checkCombos=function(){if(!(f.isVisible()||f.hasKeyboard()&&f.$keyboard.hasClass(h.css.hasFocus)))return f.getValue(f.$preview||f.$el);var e,t,a,n,i=f.getValue(),o=h.caret(f.$preview),s=h.builtLayouts[f.layout],r=f.isContentEditable?h.getEditableLength(f.el):i.length,l=r;return""===i||(o.end<o.start&&(o.end=o.start),o.start>l&&(o.end=o.start=l),h.msie&&"\n"===i.substr(o.start,1)&&(o.start+=1,o.end+=1),p.useCombos&&(h.msie?i=i.replace(f.regex,function(e,t,a){return p.combos.hasOwnProperty(t)&&p.combos[t][a]||e}):f.$preview.length&&(t=o.start-(0<=o.start-2?2:0),h.caret(f.$preview,t,o.end),a=(n=function(e){return(e||"").replace(f.regex,function(e,t,a){return p.combos.hasOwnProperty(t)&&p.combos[t][a]||e})})((t=h.caret(f.$preview)).text),t&&t.replaceStr&&a!==t.text&&(f.isContentEditable?h.replaceContent(c,n):f.setValue(t.replaceStr(a))),i=f.getValue())),p.restrictInput&&""!==i&&(t=s.acceptedKeys.length,(e=s.acceptedKeysRegex)||(a=m.map(s.acceptedKeys,function(e){return e.replace(f.escapeRegex,"\\$&")}),-1<f.alwaysAllowed.indexOf(h.keyCodes.enter)&&a.push("\\n"),e=s.acceptedKeysRegex=new RegExp("("+a.join("|")+")","g")),(a=i.match(e))?i=a.join(""):(i="",l=0)),o.start+=r-l,o.end+=r-l,f.setValue(i),f.saveCaret(o.start,o.end),f.setScroll(),f.checkMaxLength()),p.acceptValid&&f.checkValid(),i},f.checkValid=function(){var e=h.css,t=f.$keyboard.find("."+e.keyPrefix+"accept"),a=!0;m.isFunction(p.validate)&&(a=p.validate(f,f.getValue(),!1)),t.toggleClass(e.inputInvalid,!a).toggleClass(e.inputValid,a).attr("title",t.attr("data-title")+" ("+p.display[a?"valid":"invalid"]+")")},f.checkDecimal=function(){f.decimal&&/\./g.test(f.preview.value)||!f.decimal&&/\,/g.test(f.preview.value)?f.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(p.css.buttonHover).addClass(p.css.buttonDisabled):f.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(p.css.buttonDefault).removeClass(p.css.buttonDisabled)},f.getLayers=function(e){var t=h.css,a=e.attr("data-pos");return e.closest("."+t.keyboard).find('button[data-pos="'+a+'"]').filter(function(){return""!==m(this).find("."+t.keyText).text()}).add(e)},f.switchInput=function(e,t){if(m.isFunction(p.switchInput))p.switchInput(f,e,t);else{f.$keyboard.length&&f.$keyboard.hide();var a,n=!1,i=m("button, input, select, textarea, a, [contenteditable]").filter(":visible").not(":disabled"),o=i.index(f.$el)+(e?1:-1);if(f.$keyboard.length&&f.$keyboard.show(),o>i.length-1&&(n=p.stopAtEnd,o=0),o<0&&(n=p.stopAtEnd,o=i.length-1),!n){if(!(t=f.close(t)))return;(a=i.eq(o).data("keyboard"))&&a.options.openOn.length?a.focusOn():i.eq(o).focus()}}return!1},f.close=function(e){if(f.isOpen&&f.$keyboard.length){clearTimeout(f.throttled);var t=h.css,a=h.events,n=e?f.checkCombos():f.originalContent;if(e&&m.isFunction(p.validate)&&!p.validate(f,n,!0)&&(n=f.originalContent,e=!1,p.cancelClose))return;f.isCurrent(!1),f.isOpen=p.alwaysOpen||p.userClosed,f.isContentEditable&&!e?f.$el.html(n):f.setValue(n,f.$el),f.$el.removeClass(t.isCurrent+" "+t.inputAutoAccepted).addClass(e?!0===e?"":t.inputAutoAccepted:"").trigger(a.inputChange),p.alwaysOpen||f.$el.trigger(a.kbBeforeClose,[f,f.el,e||!1]),h.caret(f.$preview,f.last),f.$el.trigger(e?a.inputAccepted:a.inputCanceled,[f,f.el]).trigger(p.alwaysOpen?a.kbInactive:a.kbHidden,[f,f.el]).blur(),f&&(f.last.eventTime=(new Date).getTime(),p.alwaysOpen||p.userClosed&&"true"===e||!f.$keyboard.length||(f.removeKeyboard(),f.timer=setTimeout(function(){f&&f.bindFocus()},200)),f.watermark||""!==f.el.value||""===f.inPlaceholder||(f.$el.addClass(t.placeholder),f.setValue(f.inPlaceholder,f.$el)))}return!!e},f.accept=function(){return f.close(!0)},f.checkClose=function(e){if(!f.opening){var t=m.keyboard.css,a=e.$target||m(e.target).closest("."+h.css.keyboard+", ."+h.css.input);if(a.length||(a=m(e.target)),a.length&&a.hasClass(t.keyboard)){var n=a.data("keyboard");n!==f&&!n.$el.hasClass(t.isCurrent)&&n.options.openOn&&e.type===p.openOn&&n.focusOn()}else f.escClose(e,a)}},f.escCloseCallback={keepOpen:function(){return!f.isOpen}},f.escClose=function(e,t){if(f.isOpen){if(e&&"keyup"===e.type)return e.which!==h.keyCodes.escape||p.ignoreEsc?"":f.close(!(!p.autoAccept||!p.autoAcceptOnEsc)&&"true");var a=!1,n=t.length&&t||m(e.target);if(m.each(f.escCloseCallback,function(e,t){"function"==typeof t&&(a=a||t(n))}),!a&&(!f.isCurrent()&&f.isOpen||f.isOpen&&n[0]!==f.el)){if((p.stayOpen||p.userClosed)&&!n.hasClass(h.css.input))return;if(h.allie&&e.preventDefault(),p.closeByClickEvent){var i=n[0]&&n[0].nodeName.toLowerCase();"input"!==i&&"textarea"!==i&&"click"!==e.type||f.close(!!p.autoAccept&&"true")}else f.close(!!p.autoAccept&&"true")}}},f.keyBtn=m("<button />").attr({role:"button",type:"button","aria-disabled":"false",tabindex:"-1"}).addClass(h.css.keyButton),f.processName=function(e){var t,a,n=(e||"").replace(/[^a-z0-9-_]/gi,""),i=n.length,o=[];if(1<i&&e===n)return e;if(i=e.length){for(t=0;t<i;t++)a=e[t],o.push(/[a-z0-9-_]/i.test(a)?/[-_]/.test(a)&&0!==t?"":a:(0===t?"":"-")+a.charCodeAt(0));return o.join("")}return e},f.processKeys=function(e){var t,a=e.split(/:(?!\/\/)/),n={name:null,map:"",title:""};return/\(.+\)/.test(a[0])||/^:\(.+\)/.test(e)||/\([(:)]\)/.test(e)?/\([(:)]\)/.test(e)?(t=a[0].match(/([^(]+)\((.+)\)/))&&t.length?(n.name=t[1],n.map=t[2],n.title=1<a.length?a.slice(1).join(":"):""):(n.name=e.match(/([^(]+)/)[0],":"===n.name&&(a=a.slice(1)),null===t&&(n.map=":",a=a.slice(2)),n.title=a.length?a.join(":"):""):(n.map=e.match(/\(([^()]+?)\)/)[1],""===(t=(e=e.replace(/\(([^()]+)\)/,"")).split(":"))[0]?(n.name=":",a=a.slice(1)):n.name=t[0],n.title=1<a.length?a.slice(1).join(":"):""):(""!==e&&""===a[0]?(n.name=":",a=a.slice(1)):n.name=a[0],n.title=1<a.length?a.slice(1).join(":"):""),n.title=m.trim(n.title).replace(/_/g," "),n},f.addKey=function(e,t,a){var n,i,o,s={},r=f.processKeys(a?e:t),l=h.css;return!a&&p.display[r.name]?(o=f.processKeys(p.display[r.name])).action=f.processKeys(e).name:(o=r).action=r.name,s.name=f.processName(r.name),""!==o.name&&(""!==o.map?(h.builtLayouts[f.layout].mappedKeys[o.map]=o.name,h.builtLayouts[f.layout].acceptedKeys.push(o.name)):a&&h.builtLayouts[f.layout].acceptedKeys.push(o.name)),n=a?""===s.name?"":l.keyPrefix+s.name:l.keyAction+" "+l.keyPrefix+o.action,n+=(2<o.name.length?" "+l.keyWide:"")+" "+p.css.buttonDefault,s.html='<span class="'+l.keyText+'">'+o.name.replace(/[\u00A0-\u9999]/gim,function(e){return"&#"+e.charCodeAt(0)+";"})+"</span>",s.$key=f.keyBtn.clone().attr({"data-value":a?o.name:o.action,"data-name":o.action,"data-pos":f.temp[1]+","+f.temp[2],"data-action":o.action,"data-html":s.html}).addClass(n).html(s.html).appendTo(f.temp[0]),o.map&&s.$key.attr("data-mapped",o.map),(o.title||r.title)&&s.$key.attr({"data-title":r.title||o.title,title:r.title||o.title}),"function"==typeof p.buildKey&&(i=(s=p.buildKey(f,s)).$key.html(),s.$key.attr("data-html",i)),s.$key},f.customHash=function(e){var t,a,n,i,o=[],s=[];for(a in e=void 0===e?p.customLayout:e)e.hasOwnProperty(a)&&o.push(e[a]);if((n=0)===(i=(s=s.concat.apply(s,o).join(" ")).length))return n;for(t=0;t<i;t++)n=(n<<5)-n+s.charCodeAt(t),n&=n;return n},f.buildKeyboard=function(e,t){m.isEmptyObject(p.display)&&f.updateLanguage();var a,n,i,o,s=h.css,r=0,l=h.builtLayouts[e||f.layout||p.layout]={mappedKeys:{},acceptedKeys:[]},c=l.acceptedKeys=p.restrictInclude&&(""+p.restrictInclude).split(/\s+/)||[],d=s.keyboard+" "+p.css.popup+" "+p.css.container+(p.alwaysOpen||p.userClosed?" "+s.alwaysOpen:""),u=m("<div />").addClass(d).attr({role:"textbox"}).hide();return-1<(a=m.inArray("{space}",c))&&(c[a]=" "),t&&"custom"===p.layout||!h.layouts.hasOwnProperty(p.layout)?(p.layout="custom",d=h.layouts.custom=p.customLayout||{normal:["{cancel}"]}):d=h.layouts[t?p.layout:e||f.layout||p.layout],m.each(d,function(e,t){if(""!==e&&!/^(name|lang|rtl)$/i.test(e))for("default"===e&&(e="normal"),r++,i=m("<div />").attr("name",e).addClass(s.keySet+" "+s.keySet+"-"+e).appendTo(u).toggle("normal"===e),n=0;n<t.length;n++)o=m.trim(t[n]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}"),f.buildRow(i,n,o.split(/\s+/),c),i.find("."+s.keyButton+",."+s.keySpacer).filter(":last").after('<br class="'+s.endRow+'"/>')}),1<r&&(f.sets=!0),l.hasMappedKeys=!m.isEmptyObject(l.mappedKeys),l.$keyboard=u},f.buildRow=function(e,t,a,n){var i,o,s,r,l,c,d=h.css;for(s=0;s<a.length;s++)if(r=!(f.temp=[e,t,s]),0!==a[s].length)if(/^\{\S+\}$/.test(a[s])){if(l=a[s].match(/^\{(\S+)\}$/)[1],/\!\!/.test(l)&&(l=l.replace("!!",""),r=!0),/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i.test(l)&&(c=parseFloat(l.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0),m('<span class="'+d.keyText+'"></span>').width(l.match(/px/i)?c+"px":2*c+"em").addClass(d.keySpacer).appendTo(e)),/^empty(:((\d+)?([\.|,]\d+)?)(em|px)?)?$/i.test(l)){c=/:/.test(l)?parseFloat(l.replace(/,/,".").match(/^empty:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0):"",f.addKey(""," ",!0).addClass(p.css.buttonDisabled+" "+p.css.buttonEmpty).attr("aria-disabled",!0).width(c?l.match("px")?c+"px":2*c+"em":"");continue}if(/^meta[\w-]+\:?(\w+)?/i.test(l)){f.addKey(l.split(":")[0],l).addClass(d.keyHasActive);continue}switch((o=l.split(":"))[0].toLowerCase()){case"a":case"accept":f.addKey("accept",l).addClass(p.css.buttonAction+" "+d.keyAction);break;case"alt":case"altgr":f.addKey("alt",l).addClass(d.keyHasActive);break;case"b":case"bksp":f.addKey("bksp",l);break;case"c":case"cancel":f.addKey("cancel",l).addClass(p.css.buttonAction+" "+d.keyAction);break;case"combo":f.addKey("combo",l).addClass(d.keyHasActive).attr("title",function(e,t){return t+" "+p.display[p.useCombos?"active":"disabled"]}).toggleClass(p.css.buttonActive,p.useCombos);break;case"dec":n.push(f.decimal?".":","),f.addKey("dec",l);break;case"e":case"enter":f.addKey("enter",l).addClass(p.css.buttonAction+" "+d.keyAction);break;case"lock":f.addKey("lock",l).addClass(d.keyHasActive);break;case"s":case"shift":f.addKey("shift",l).addClass(d.keyHasActive);break;case"sign":n.push("-"),f.addKey("sign",l);break;case"space":n.push(" "),f.addKey("space",l);break;case"t":case"tab":f.addKey("tab",l);break;default:h.keyaction.hasOwnProperty(o[0])&&f.addKey(o[0],l).toggleClass(p.css.buttonAction+" "+d.keyAction,r)}}else i=a[s],f.addKey(i,i,!0)},f.removeBindings=function(e){m(document).unbind(e),f.el.ownerDocument!==document&&m(f.el.ownerDocument).unbind(e),m(window).unbind(e),f.$el.unbind(e)},f.removeKeyboard=function(){f.$decBtn=[],p.usePreview&&f.$preview.removeData("keyboard"),f.$preview.unbind(f.namespace+"keybindings"),f.preview=null,f.$preview=null,f.$previewCopy=null,f.$keyboard.removeData("keyboard"),f.$keyboard.remove(),f.$keyboard=[],f.isOpen=!1,f.isCurrent(!1)},f.destroy=function(e){var t,a=h.css,n=f.extensionNamespace.length,i=[a.input,a.locked,a.placeholder,a.noKeyboard,a.alwaysOpen,p.css.input,a.isCurrent].join(" ");for(clearTimeout(f.timer),clearTimeout(f.timer2),clearTimeout(f.timer3),f.$keyboard.length&&f.removeKeyboard(),f.removeBindings(f.namespace),f.removeBindings(f.namespace+"callbacks"),t=0;t<n;t++)f.removeBindings(f.extensionNamespace[t]);f.el.active=!1,f.$el.removeClass(i).removeAttr("aria-haspopup").removeAttr("role").removeData("keyboard"),f=null,"function"==typeof e&&e()},f.init()};return h.keyCodes={backSpace:8,tab:9,enter:13,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,A:65,Z:90,V:86,C:67,X:88,a:97,z:122},h.css={idSuffix:"_keyboard",initialFocus:"keyboard-init-focus",input:"ui-keyboard-input",inputClone:"ui-keyboard-preview-clone",wrapper:"ui-keyboard-preview-wrapper",preview:"ui-keyboard-preview",keyboard:"ui-keyboard",keySet:"ui-keyboard-keyset",keyButton:"ui-keyboard-button",keyWide:"ui-keyboard-widekey",keyPrefix:"ui-keyboard-",keyText:"ui-keyboard-text",keyHasActive:"ui-keyboard-hasactivestate",keyAction:"ui-keyboard-actionkey",keySpacer:"ui-keyboard-spacer",keyToggle:"ui-keyboard-toggle",keyDisabled:"ui-keyboard-disabled",divWrapperCE:"ui-keyboard-div-wrapper",locked:"ui-keyboard-lockedinput",alwaysOpen:"ui-keyboard-always-open",noKeyboard:"ui-keyboard-nokeyboard",placeholder:"ui-keyboard-placeholder",hasFocus:"ui-keyboard-has-focus",isCurrent:"ui-keyboard-input-current",inputValid:"ui-keyboard-valid-input",inputInvalid:"ui-keyboard-invalid-input",inputAutoAccepted:"ui-keyboard-autoaccepted",endRow:"ui-keyboard-button-endrow"},h.events={kbChange:"keyboardChange",kbBeforeClose:"beforeClose",kbBeforeVisible:"beforeVisible",kbVisible:"visible",kbInit:"initialized",kbInactive:"inactive",kbHidden:"hidden",kbRepeater:"repeater",kbKeysetChange:"keysetChange",inputAccepted:"accepted",inputCanceled:"canceled",inputChange:"change",inputRestricted:"restricted"},h.keyaction={accept:function(e){return e.close(!0),!1},alt:function(e){e.altActive=!e.altActive,e.showSet()},bksp:function(e){e.isContentEditable?(e.execCommand("delete"),e.saveCaret()):e.insertText("\b")},cancel:function(e){return e.close(),!1},clear:function(e){e.$preview[e.isContentEditable?"text":"val"](""),e.$decBtn.length&&e.checkDecimal()},combo:function(e){var t=e.options,a=!t.useCombos,n=e.$keyboard.find("."+h.css.keyPrefix+"combo");return t.useCombos=a,n.toggleClass(t.css.buttonActive,a).attr("title",n.attr("data-title")+" ("+t.display[a?"active":"disabled"]+")"),a&&e.checkCombos(),!1},dec:function(e){e.insertText(e.decimal?".":",")},del:function(e){e.isContentEditable?e.execCommand("forwardDelete"):e.insertText("{d}")},default:function(e){e.shiftActive=e.altActive=e.metaActive=!1,e.showSet()},enter:function(e,t,a){var n=e.el.nodeName,i=e.options;return a.shiftKey?i.enterNavigation?e.switchInput(!a[i.enterMod],!0):e.close(!0):i.enterNavigation&&("TEXTAREA"!==n||a[i.enterMod])?e.switchInput(!a[i.enterMod],!!i.autoAccept&&"true"):("TEXTAREA"===n&&m(a.target).closest("button").length&&e.insertText((h.msie?" ":"")+"\n"),void(e.isContentEditable&&!i.enterNavigation&&(e.execCommand("insertHTML",'<div><br class="'+h.css.divWrapperCE+'"></div>'),setTimeout(function(){h.keyaction.right(e),e.saveCaret()},0))))},lock:function(e){e.last.keyset[0]=e.shiftActive=e.capsLock=!e.capsLock,e.showSet()},left:function(e){var t=h.caret(e.$preview);0<=t.start-1&&(e.last.start=e.last.end=t.start-1,h.caret(e.$preview,e.last),e.setScroll())},meta:function(e,t){var a=m(t);e.metaActive=!a.hasClass(e.options.css.buttonActive),e.showSet(a.attr("data-name"))},next:function(e){return e.switchInput(!0,e.options.autoAccept),!1},normal:function(e){e.shiftActive=e.altActive=e.metaActive=!1,e.showSet()},prev:function(e){return e.switchInput(!1,e.options.autoAccept),!1},right:function(e){var t=h.caret(e.$preview),a=e.isContentEditable?h.getEditableLength(e.el):e.getValue().length;t.end+1<=a&&(e.last.start=e.last.end=t.end+1,h.caret(e.$preview,e.last),e.setScroll())},shift:function(e){e.last.keyset[0]=e.shiftActive=!e.shiftActive,e.showSet()},sign:function(e){if(/^[+-]?\d*\.?\d*$/.test(e.getValue())){var t,a=h.caret(e.$preview),n=e.getValue(),i=e.isContentEditable?h.getEditableLength(e.el):n.length;e.setValue(-1*n),t=i-n.length,e.last.start=a.start+t,e.last.end=a.end+t,h.caret(e.$preview,e.last),e.setScroll()}},space:function(e){e.insertText(" ")},tab:function(e){var t=e.el.nodeName,a=e.options;if("TEXTAREA"!==t){if(a.tabNavigation)return e.switchInput(!e.shiftActive,!0);if("INPUT"===t)return!1}e.insertText("\t")},toggle:function(e){e.enabled=!e.enabled,e.toggle()},NBSP:" ",ZWSP:"​",ZWNJ:"‌",ZWJ:"‍",LRM:"‎",RLM:"‏"},h.builtLayouts={},h.layouts={alpha:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}","{tab} ä å é ® þ ü ú í ó ö « » ¬","á ß ð f g h j k ø ¶ ´ {enter}","{shift} æ x © v b ñ µ ç > ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}","{tab} Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦","Ä § Ð F G H J K Ø ° ¨ {enter}","{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"]},colemak:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w f p g j l u y ; [ ] \\","{bksp} a r s t d h n e i o ' {enter}","{shift} z x c v b k m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W F P G J L U Y : { } |",'{bksp} A R S T D H N E I O " {enter}',"{shift} Z X C V B K M < > ? {shift}","{accept} {space} {cancel}"]},dvorak:{normal:["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{normal:["= ( ) {b}","{clear} / * -","7 8 9 +","4 5 6 {sign}","1 2 3 %","0 {dec} {a} {c}"]}},h.language={en:{display:{a:"✔:Accept (Shift+Enter)",accept:"Accept:Accept (Shift+Enter)",alt:"Alt:⌥ AltGr",b:"⌫:Backspace",bksp:"Bksp:Backspace",c:"✖:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"ö:Toggle Combo Keys",dec:".:Decimal",e:"⏎:Enter",empty:" ",enter:"Enter:Enter ⏎",left:"←",lock:"Lock:⇪ Caps Lock",next:"Next ⇨",prev:"⇦ Prev",right:"→",s:"⇧:Shift",shift:"Shift:Shift",sign:"±:Change Sign",space:" :Space",t:"⇥:Tab",tab:"⇥ Tab:Tab",toggle:" ",valid:"valid",invalid:"invalid",active:"active",disabled:"disabled"},wheelMessage:"Use mousewheel to see other keys",comboRegex:/([`\'~\^\"ao])([a-z])/gim,combos:{"`":{a:"à",A:"À",e:"è",E:"È",i:"ì",I:"Ì",o:"ò",O:"Ò",u:"ù",U:"Ù",y:"ỳ",Y:"Ỳ"},"'":{a:"á",A:"Á",e:"é",E:"É",i:"í",I:"Í",o:"ó",O:"Ó",u:"ú",U:"Ú",y:"ý",Y:"Ý"},'"':{a:"ä",A:"Ä",e:"ë",E:"Ë",i:"ï",I:"Ï",o:"ö",O:"Ö",u:"ü",U:"Ü",y:"ÿ",Y:"Ÿ"},"^":{a:"â",A:"Â",e:"ê",E:"Ê",i:"î",I:"Î",o:"ô",O:"Ô",u:"û",U:"Û",y:"ŷ",Y:"Ŷ"},"~":{a:"ã",A:"Ã",e:"ẽ",E:"Ẽ",i:"ĩ",I:"Ĩ",o:"õ",O:"Õ",u:"ũ",U:"Ũ",y:"ỹ",Y:"Ỹ",n:"ñ",N:"Ñ"}}}},h.defaultOptions={language:null,rtl:!1,layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},reposition:!0,usePreview:!0,alwaysOpen:!1,initialFocus:!0,noFocus:!1,stayOpen:!1,userClosed:!1,ignoreEsc:!1,closeByClickEvent:!1,css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",popup:"",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonActive:"ui-state-active",buttonDisabled:"ui-state-disabled",buttonEmpty:"ui-keyboard-empty"},autoAccept:!1,autoAcceptOnEsc:!1,lockInput:!1,restrictInput:!1,restrictInclude:"",acceptValid:!1,autoAcceptOnValid:!1,checkValidOnInit:!0,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,appendTo:"body",wrapBRs:!0,stickyShift:!0,preventPaste:!1,caretToEnd:!1,scrollAdjustment:10,maxLength:!1,maxInsert:!0,repeatDelay:500,repeatRate:20,resetDefault:!0,openOn:"focus",activeOnReadonly:!1,keyBinding:"mousedown touchstart",useWheel:!0,useCombos:!0,validate:function(){return!0}},h.comboRegex=/([`\'~\^\"ao])([a-z])/gim,h.currentKeyboard="",m('\x3c!--[if lte IE 8]><script>jQuery("body").addClass("oldie");<\/script><![endif]--\x3e\x3c!--[if IE]><script>jQuery("body").addClass("ie");<\/script><![endif]--\x3e').appendTo("body").remove(),h.msie=m("body").hasClass("oldie"),h.allie=m("body").hasClass("ie"),h.watermark=void 0!==document.createElement("input").placeholder,h.checkCaretSupport=function(){if("boolean"!=typeof h.checkCaret){var e=m('<div style="height:0px;width:0px;overflow:hidden;position:fixed;top:0;left:-100px;"><input type="text" value="testing"/></div>').prependTo("body");h.caret(e.find("input"),3,3),h.checkCaret=3!==h.caret(e.find("input").hide().show()).start,e.remove()}return h.checkCaret},h.caret=function(e,t,a){if(!e||!e.length||e.is(":hidden")||"hidden"===e.css("visibility"))return{};var n,i,o,s,r=e.data("keyboard"),l=r&&r.options.noFocus,c=/(textarea|input)/i.test(e[0].nodeName);return l||e.focus(),void 0!==t?("object"==typeof t&&"start"in t&&"end"in t?(n=t.start,i=t.end):void 0===a&&(a=t),"number"==typeof t&&"number"==typeof a?(n=t,i=a):"start"===t?n=i=0:"string"==typeof t&&(n=i="end"),c?e.caret(n,i,l):h.setEditableCaret(e,n,i)):(s=c?e.caret():h.getEditableCaret(e[0]),n=s.start,i=s.end,o=c&&e[0].value||e.text()||"",{start:n,end:i,text:o.substring(n,i),replaceStr:function(e){return o.substring(0,n)+e+o.substring(i,o.length)}})},h.isTextNode=function(e){return e&&3===e.nodeType},h.isBlock=function(e,t){var a=e.ownerDocument.defaultView;return t&&1===t.nodeType&&t!==e&&"block"===a.getComputedStyle(t).display?1:0},h.wrapBRs=function(n){var e=m(n).find("br:not(."+h.css.divWrapperCE+")");e.length&&m.each(e,function(e,t){var a=t.parentNode.childNodes.length;(1!==a||1===a&&!h.isBlock(n,t.parentNode))&&m(t).addClass(h.css.divWrapperCE).wrap("<div>")})},h.getEditableCaret=function(l){if(!(l=m(l)[0]).isContentEditable)return{};var e,t,c=(m(l).data("keyboard")||{}).options,a=l.ownerDocument.getSelection().getRangeAt(0),n=o(a.startContainer,a.startOffset),i=n.position;function o(e,t){var a,n="",i=!1,o=0,s=m.makeArray(l.childNodes);function r(e){e&&(o+=e,n+=c&&c.replaceCR||"\n")}for(;!i&&s.length;){if((a=s.shift())===e&&(i=!0),r(h.isBlock(l,a.previousSibling)),h.isTextNode(a)){if(o+=i?t:a.length,n+=a.textContent,i)return{position:o,text:n}}else!i&&a.childNodes&&(s=m.makeArray(a.childNodes).concat(s));r(h.isTextNode(a.previousSibling)&&h.isBlock(l,a))}return{position:o,text:n}}return!1!==c.wrapBRs&&h.wrapBRs(l),a.endContainer===a.startContainer&&a.endOffset===a.startOffset?(e=i,t=""):(e=(n=o(a.endContainer,a.endOffset)).position,t=n.text.substring(i,e)),{start:i,end:e,text:t}},h.getEditableLength=function(e){var t=h.setEditableCaret(e,"getMax");return"number"==typeof t?t:null},h.setEditableCaret=function(u,e,t){if(!(u=m(u)[0]).isContentEditable)return{};var a=u.ownerDocument,n=a.createRange(),i=a.getSelection(),p=(m(u).data("keyboard")||{}).options,o=e,s=t,r="",l=c("getMax"===e?"end":e);function c(a){"end"===a?a=u.innerHTML.length:a<0&&(a=0);var e,t,n="",i=!1,o=0,s=0,r=0,l=m.makeArray(u.childNodes);function c(e){return n+=e?p&&p.replaceCR||"\n":"",0<e}function d(e){var t=o+e;return s=r,r+=e,0<=a-t?a-(o=t)<=0:a-t<=0}for(;!i&&l.length;)if(e=l.shift(),c(t=h.isBlock(u,e.previousSibling))&&d(t)&&(i=!0),c(t=h.isTextNode(e.previousSibling)&&h.isBlock(u,e))&&d(t)&&(i=!0),h.isTextNode(e)){if(n+=e.textContent,d(e.length))return{node:e,offset:t=a-o==0&&1<=o-s?e.length:a-o,position:a,text:n}}else!i&&e.childNodes&&(l=m.makeArray(e.childNodes).concat(l));return l.length?{node:e,offset:a-o,position:a,text:n}:{node:e,offset:e&&e.length||0,position:r,text:n}}if(l.node){if(o=l.position,"getMax"===e)return o;n.setStart(l.node,l.offset),void 0!==t&&t!==e&&(l=c(t)),l.node&&(s=l.position,n.setEnd(l.node,l.offset),r=o===s?"":l.text.substring(o,s)),i.removeAllRanges(),i.addRange(n)}return{start:o,end:s,text:r}},h.replaceContent=function(e,t){e=m(e)[0];for(var a,n,i,o=typeof t,s=h.getEditableCaret(e).start,r=0,l=[e];a=l.pop();)if(h.isTextNode(a))"function"===o?r<=s&&s<=r+a.length&&(a.textContent=t(a.textContent)):"string"===o&&(i=t.substring(r,r+a.length))!==a.textContent&&(a.textContent=i),r+=a.length;else if(a&&a.childNodes)for(n=a.childNodes.length;n--;)l.push(a.childNodes[n]);n=h.getEditableCaret(e),h.setEditableCaret(e,n.start,n.start)},m.fn.keyboard=function(e){return this.each(function(){m(this).data("keyboard")||new m.keyboard(this,e)})},m.fn.getkeyboard=function(){return this.data("keyboard")},m.fn.caret=function(t,a,e){if(void 0===this[0]||this.is(":hidden")||"hidden"===this.css("visibility")||!/(INPUT|TEXTAREA)/.test(this[0].nodeName))return this;var n,i,o,s,r,l=this,c=l[0],d=c.ownerDocument.selection,u=c.scrollTop,p=!1,f=!0;try{p="selectionStart"in c}catch(e){f=!1}return f&&void 0!==t?(/(email|number)/i.test(c.type)||(p?(c.selectionStart=t,c.selectionEnd=a):((n=c.createTextRange()).collapse(!0),n.moveStart("character",t),n.moveEnd("character",a-t),n.select())),e||!l.is(":visible")&&"hidden"===l.css("visibility")||c.focus(),c.scrollTop=u,this):(/(email|number)/i.test(c.type)?t=a=l.val().length:p?(t=c.selectionStart,a=c.selectionEnd):d?"TEXTAREA"===c.nodeName?(r=l.val(),(o=(i=d.createRange()).duplicate()).moveToElementText(c),o.setEndPoint("EndToEnd",i),t=o.text.replace(/\r/g,"\n").length,a=t+i.text.replace(/\r/g,"\n").length):(r=l.val().replace(/\r/g,"\n"),(i=d.createRange().duplicate()).moveEnd("character",r.length),t=""===i.text?r.length:r.lastIndexOf(i.text),(i=d.createRange().duplicate()).moveStart("character",-r.length),a=i.text.length):t=a=(c.value||"").length,s=c.value||"",{start:t,end:a,text:s.substring(t,a),replace:function(e){return s.substring(0,t)+e+s.substring(a,s.length)}})},h});